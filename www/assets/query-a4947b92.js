const n=new WeakMap,h=new WeakMap,m=new WeakSet,d=new WeakMap;class v{constructor(e,s){this.handleFormData=t=>{const o=this.options.disabled(this.host),i=this.options.name(this.host),r=this.options.value(this.host),f=this.host.tagName.toLowerCase()==="syn-button";!o&&!f&&typeof i=="string"&&i.length>0&&typeof r<"u"&&(Array.isArray(r)?r.forEach(a=>{t.formData.append(i,a.toString())}):t.formData.append(i,r.toString()))},this.handleFormSubmit=t=>{const o=this.options.disabled(this.host),i=this.options.reportValidity;this.form&&!this.form.noValidate&&n.get(this.form)?.forEach(r=>{this.setUserInteracted(r,!0)}),this.form&&!this.form.noValidate&&!o&&!i(this.host)&&(t.preventDefault(),t.stopImmediatePropagation())},this.handleFormReset=()=>{this.options.setValue(this.host,this.options.defaultValue(this.host)),this.setUserInteracted(this.host,!1),d.set(this.host,[])},this.handleInteraction=t=>{const o=d.get(this.host);o.includes(t.type)||o.push(t.type),o.length===this.options.assumeInteractionOn.length&&this.setUserInteracted(this.host,!0)},this.reportFormValidity=()=>{if(this.form&&!this.form.noValidate){const t=this.form.querySelectorAll("*");for(const o of t)if(typeof o.reportValidity=="function"&&!o.reportValidity())return!1}return!0},(this.host=e).addController(this),this.options={form:t=>{if(t.hasAttribute("form")&&t.getAttribute("form")!==""){const o=t.getRootNode(),i=t.getAttribute("form");if(i)return o.getElementById(i)}return t.closest("form")},name:t=>t.name,value:t=>t.value,defaultValue:t=>t.defaultValue,disabled:t=>t.disabled??!1,reportValidity:t=>typeof t.reportValidity=="function"?t.reportValidity():!0,setValue:(t,o)=>t.value=o,assumeInteractionOn:["syn-input"],...s}}hostConnected(){const e=this.options.form(this.host);e&&this.attachForm(e),d.set(this.host,[]),this.options.assumeInteractionOn.forEach(s=>{this.host.addEventListener(s,this.handleInteraction)})}hostDisconnected(){this.detachForm(),d.delete(this.host),this.options.assumeInteractionOn.forEach(e=>{this.host.removeEventListener(e,this.handleInteraction)})}hostUpdated(){const e=this.options.form(this.host);e||this.detachForm(),e&&this.form!==e&&(this.detachForm(),this.attachForm(e)),this.host.hasUpdated&&this.setValidity(this.host.validity.valid)}attachForm(e){e?(this.form=e,n.has(this.form)?n.get(this.form).add(this.host):n.set(this.form,new Set([this.host])),this.form.addEventListener("formdata",this.handleFormData),this.form.addEventListener("submit",this.handleFormSubmit),this.form.addEventListener("reset",this.handleFormReset),h.has(this.form)||(h.set(this.form,this.form.reportValidity),this.form.reportValidity=()=>this.reportFormValidity())):this.form=void 0}detachForm(){this.form&&(n.get(this.form)?.delete(this.host),this.form.removeEventListener("formdata",this.handleFormData),this.form.removeEventListener("submit",this.handleFormSubmit),this.form.removeEventListener("reset",this.handleFormReset),h.has(this.form)&&(this.form.reportValidity=h.get(this.form),h.delete(this.form))),this.form=void 0}setUserInteracted(e,s){s?m.add(e):m.delete(e),e.requestUpdate()}doAction(e,s){if(this.form){const t=document.createElement("button");t.type=e,t.style.position="absolute",t.style.width="0",t.style.height="0",t.style.clipPath="inset(50%)",t.style.overflow="hidden",t.style.whiteSpace="nowrap",s&&(t.name=s.name,t.value=s.value,["formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(o=>{s.hasAttribute(o)&&t.setAttribute(o,s.getAttribute(o))})),this.form.append(t),t.click(),t.remove()}}getForm(){return this.form??null}reset(e){this.doAction("reset",e)}submit(e){this.doAction("submit",e)}setValidity(e){const s=this.host,t=!!m.has(s),o=!!s.required;s.toggleAttribute("data-required",o),s.toggleAttribute("data-optional",!o),s.toggleAttribute("data-invalid",!e),s.toggleAttribute("data-valid",e),s.toggleAttribute("data-user-invalid",!e&&t),s.toggleAttribute("data-user-valid",e&&t)}updateValidity(){const e=this.host;this.setValidity(e.validity.valid)}emitInvalidEvent(e){const s=new CustomEvent("syn-invalid",{bubbles:!1,composed:!1,cancelable:!0,detail:{}});e||s.preventDefault(),this.host.dispatchEvent(s)||e?.preventDefault()}}const u=Object.freeze({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1}),y=Object.freeze({...u,valid:!1,valueMissing:!0}),g=Object.freeze({...u,valid:!1,customError:!0});/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const c=(l,e,s)=>(s.configurable=!0,s.enumerable=!0,Reflect.decorate&&typeof e!="object"&&Object.defineProperty(l,e,s),s);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function b(l,e){return(s,t,o)=>{const i=r=>r.renderRoot?.querySelector(l)??null;if(e){const{get:r,set:f}=typeof t=="object"?s:o??(()=>{const a=Symbol();return{get(){return this[a]},set(p){this[a]=p}}})();return c(s,t,{get(){if(e){let a=r.call(this);return a===void 0&&(a=i(this),f.call(this,a)),a}return i(this)}})}return c(s,t,{get(){return i(this)}})}}export{v as F,u as a,g as c,b as e,y as v};
//# sourceMappingURL=query-a4947b92.js.map
